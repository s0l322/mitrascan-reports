<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>MitraScan - Informe de Auditor√≠a Web</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

/* -------------------- GLOBAL DARK THEME -------------------- */

body {
  font-family: 'Segoe UI', Arial, sans-serif;
  background-color: #0b0c10;
  color: #e6e6e6;
  margin: 0;
  padding: 0;
}

section {
  margin: 40px auto;
  max-width: 950px;
  background: #1c1c28;
  padding: 35px;
  border-radius: 12px;
  box-shadow: 0 0 18px #00aaff33;
}

h1, h2, h3 {
  color: #00d8ff;
}

/* -------------------- LOGO -------------------- */

#logo-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
}

#logo-container img {
  height: 70px;
  opacity: 0.90;
}

/* -------------------- PORTADA -------------------- */

#portada {
  text-align: center;
  background: #111827;
  padding: 80px 20px 60px 20px;
  border-radius: 15px;
  margin-top: 40px;
  box-shadow: 0 0 20px #00aaff55;
}

#portada h1 {
  font-size: 2.5em;
  color: #00d8ff;
}

#portada .info {
  margin-top: 20px;
  font-size: 1.2em;
}

/* -------------------- NAV -------------------- */

nav {
  position: sticky;
  top: 0;
  background: #081018;
  backdrop-filter: blur(6px);
  padding: 10px 0;
  z-index: 100;
  border-bottom: 1px solid #00aaff44;
}

nav a {
  margin: 0 18px;
  color: #00d8ff;
  text-decoration: none;
  font-size: 1.1em;
  padding-bottom: 5px;
}

nav a:hover {
  border-bottom: 2px solid #00d8ff;
}

/* -------------------- GR√ÅFICOS -------------------- */

.charts-wrapper {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 10px;
}

.chart-container {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;     /* Centra horizontal */
  justify-content: center; /* Centra vertical */
  padding: 20px 0;
  text-align: center;
}

.chart-container canvas {
  display: block;
  margin: 0 auto;
  max-width: 350px;
  max-height: 350px;
}


.counter {
  font-size: 2.8em;
  font-weight: bold;
  margin-top: 15px;
}

/* colores por severidad */
.low { color: #00ff99; }
.medium { color: #ffcc00; }
.high { color: #ff4444; }

/* -------------------- TABLE -------------------- */

table {
  width: 100%;
  background: #111;
  border-collapse: collapse;
  margin-top: 25px;
}

table th {
  background: #00aaff;
  color: #000;
  padding: 10px;
}

table td {
  padding: 8px;
  border: 1px solid #333;
}

/* -------------------- RESULTS RAW -------------------- */

pre {
  background: #000;
  color: #00ff00;
  padding: 12px;
  border-radius: 8px;
  font-size: 0.95em;
  overflow-x: auto;
}

/* -------------------- ACCORDION -------------------- */

.accordion {
  background: #0d1117;
  color: #00d8ff;
  cursor: pointer;
  padding: 15px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 1.2em;
  border-radius: 8px;
  margin-top: 10px;
  transition: 0.3s;
}

.accordion:hover {
  background: #112233;
}

.panel {
  padding: 0 10px;
  display: none;
  background-color: #000;
  border-left: 3px solid #00aaff55;
  border-right: 3px solid #00aaff55;
  border-bottom: 3px solid #00aaff55;
  border-radius: 0 0 8px 8px;
  margin-bottom: 20px;
}

/* -------------------- FOOTER -------------------- */

footer {
  text-align: center;
  margin: 50px 0;
  color: #888;
  font-size: 0.9em;
}

</style>

</head>
<body>

<!-- LOGO -->
<div id="logo-container">
  <img src="logo_mitrascan.png" alt="Logo MitraScan">
</div>

<!-- ========================== NAV ========================== -->
<nav>
  <center>
    <a href="#portada">Inicio</a>
    <a href="#resumen">Resumen</a>
    <a href="#descripcion">Descripci√≥n</a>
    <a href="#graficos">Gr√°ficos</a>
    <a href="#normativa">Normativa</a>
    <a href="#mitigacion">Mitigaci√≥n</a>
    <a href="#resultados">Resultados</a>
  </center>
</nav>

<!-- ========================== PORTADA ========================== -->
<section id="portada">
  <h1>Informe de Auditor√≠a Web Automatizada</h1>
  <h2>Generado por MitraScan</h2>

  <div class="info">
      Auditor√≠a realizada por: <b>Valentina Mendoza</b><br>
      Identificador √∫nico del reporte:<br>
      <b>4f97284fffbf63197a9428dc179228a0d44a6e1c02f0fc431871d1593acf93e3</b>
  </div>
</section>

<!-- ========================== RESUMEN ========================== -->
<section id="resumen">
  <h2>Resumen Ejecutivo</h2>
  
<h3>Fecha del informe: 2025-12-04 20:16</h3>
<h3>Total hallazgos: 1</h3>
<h3>Nivel de riesgo global: 100.0%</h3>

</section>

<!-- ========================== DESCRIPCI√ìN ========================== -->
<section id="descripcion">
  <h2>Descripci√≥n T√©cnica del Escaneo</h2>
  
<h3>Descripci√≥n T√©cnica del Escaneo</h3>
<p>
El an√°lisis utiliza <b>Nmap</b>, <b>Nikto</b> y <b>Nuclei</b> para identificar 
vulnerabilidades relacionadas con configuraci√≥n, exposici√≥n de archivos, 
cabeceras de seguridad y servicios accesibles. Los hallazgos se presentan 
en una tabla consolidada para facilitar una lectura ejecutiva y clara.
</p>

<table>
<tr>
<th>Severidad</th>
<th>Vulnerabilidad</th>
<th>Recomendaci√≥n</th>
</tr>

<tr>
<td style='color:#ff4444; font-weight:bold;'>Alta</td>
<td>hsts missing</td>
<td>Habilitar Strict-Transport-Security.</td>
</tr>

<tr>
<td style='color:#ffcc00;'>Media</td>
<td colspan='2'>No se identificaron hallazgos en esta categor√≠a.</td>
</tr>

<tr>
<td style='color:#00ff99;'>Baja</td>
<td colspan='2'>No se identificaron hallazgos en esta categor√≠a.</td>
</tr>
</table>
</section>

<!-- ========================== GR√ÅFICOS ========================== -->
<section id="graficos">
  <h2>Resumen Gr√°fico</h2>

  <div class="chart-container">
    <h3>Distribuci√≥n de Riesgos</h3>
    <canvas id="riskPie"></canvas>
  </div>

  <center>
    <div id="riskScore" class="counter">0%</div>
    <div id="riskText" style="font-size:1.5em;"></div>
  </center>

<script>
const low = Number(0);
const medium = Number(0);
const high = Number(1);

const total = low + medium + high;

const riskScore = total === 0 
  ? 0 
  : Math.min(((medium*2 + high*3) / (total*3)) * 100, 100);

document.getElementById("riskScore").textContent = riskScore.toFixed(1) + "%";

let txt = document.getElementById("riskText");
if (riskScore < 40) { txt.textContent="RIESGO BAJO"; txt.style.color="#00ff99"; }
else if (riskScore < 70) { txt.textContent="RIESGO MEDIO"; txt.style.color="#ffcc00"; }
else { txt.textContent="RIESGO ALTO"; txt.style.color="#ff4444"; }

new Chart(riskPie, {
  type:'doughnut',
  data:{
    labels:['Bajo','Medio','Alto'],
    datasets:[{
      data:[low,medium,high],
      backgroundColor:['#00ff99','#ffcc00','#ff4444']
    }]
  },
  options:{
    plugins:{
      legend:{
        position: 'bottom',
        labels:{
          color:'#fff',
          padding: 15,
          boxWidth: 18,
          boxHeight: 10
        }
      }
    }
  }
});
</script>

</section>
<!-- ========================== NORMATIVA ========================== -->
<section id="normativa">
  <h2>Clasificaci√≥n Normativa</h2>
  
<table>
<tr>
<th>Vulnerabilidad</th>
<th>MITRE</th>
<th>ISO 27001</th>
<th>ISO 27002</th>
<th>OWASP</th>
<th>Ley 21.459</th>
</tr>

<tr>
<td>hsts missing</td>
<td>T1557 ‚Äì Man-in-the-Middle</td>
<td>A.8.23 ‚Äì Gesti√≥n de redes</td>
<td>8.24 ‚Äì Comunicaci√≥n segura</td>
<td>A02:2021 ‚Äì Cryptographic Failures</td>
<td>Art. 3 ‚Äì Seguridad de comunicaciones</td>
</tr>
</table>
</section>
<!-- ======================== RESULTADOS DETALLADOS ======================== -->
<section id="resultados">
  <h2>Resultados Detallados</h2>

  <button class="accordion">üõ∞Ô∏è Nmap</button>
  <div class="panel">
    <pre>Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-04 19:57 -03
Nmap done: 0 IP addresses (0 hosts up) scanned in 0.21 seconds
</pre>
  </div>

  <button class="accordion">üß© Nikto</button>
  <div class="panel">
    <pre>- Nikto v2.5.0
---------------------------------------------------------------------------
+ Multiple IPs found: 54.220.192.176, 46.137.15.86, 54.73.53.134
+ Target IP:          54.220.192.176
+ Target Hostname:    juice-shop.herokuapp.com
+ Target Port:        443
---------------------------------------------------------------------------
+ SSL Info:        Subject:  /CN=*.herokuapp.com
                   Ciphers:  ECDHE-RSA-AES128-GCM-SHA256
                   Issuer:   /C=US/O=Amazon/CN=Amazon RSA 2048 M02
+ Start Time:         2025-12-04 19:57:11 (GMT-3)
---------------------------------------------------------------------------
+ Server: Heroku
+ /: Retrieved via header: 1.1 heroku-router.
+ /: Retrieved access-control-allow-origin header: *.
+ /: Uncommon header 'x-recruiting' found, with contents: /#/jobs.
+ /: Uncommon header 'reporting-endpoints' found, with contents: heroku-nel="https://nel.heroku.com/reports?s=a0MhSCeHm3IgLGo%2FuSgpqKNN6TSuUT8JLGRf%2FCjY52c%3D&sid=812dcc77-0bd0-43b1-a5f1-b25750382959&ts=1764889112".
+ /: The site uses TLS and the Strict-Transport-Security HTTP header is not defined. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security
+ Scan terminated: 0 error(s) and 5 item(s) reported on remote host
+ End Time:           2025-12-04 19:57:54 (GMT-3) (43 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</pre>
  </div>

  <button class="accordion">üîç Nuclei</button>
  <div class="panel">
    <pre>[[92mprometheus-metrics[0m] [[94mhttp[0m] [[33mmedium[0m] https://juice-shop.herokuapp.com/metrics
</pre>
  </div>

<script>
const acc = document.getElementsByClassName("accordion");
for (let i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function () {
    this.classList.toggle("active");
    const panel = this.nextElementSibling;
    panel.style.display = (panel.style.display === "block") ? "none" : "block";
  });
}
</script>

</section>

<footer>
¬© 2025 MitraScan ‚Äì Inteligencia en Auditor√≠a Web | Desarrollado por Valentina Mendoza
</footer>

</body>
</html>
